/*!
 * Normalizing the accelerometer and gyro in 3d space
 *
 * @author Blake Kus <http://blakek.us>
 * @copyright Blake Kus <http://blakek.us>
 * @version 0.0.1
 * @license MIT License
 */
!function(n,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():n.deviceOrientation=e()}(this,function(){var n=[],e=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),i=/Android/i.test(navigator.userAgent),a=null,t=0,o={},c={},r=null,d=null,l=null,s=null,u=null,w=null,v=9.78,f=function(){window&&window.addEventListener&&("undefined"!=typeof window.orientation&&(null==u&&(u=window.orientation),w=window.orientation,window.addEventListener("orientationchange",function(){w=window.orientation,a=null,t=0,g()},!1)),window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",function(n){if(null==a&&(t++,t>4&&(a=n.alpha)),r=n.alpha-a,o.a=n.alpha,c.a=r,i)switch(!0){case 0==u&&0==w:case 90==u&&0==w:case-90==u&&0==w:r>180&&(r=-1*(360-r));break;case 0==u&&-90==w:case 90==u&&-90==w:case-90==u&&-90==w:r*=-1;break;case 0==u&&90==w:case 90==u&&90==w:case-90==u&&90==w:0>r?r=Math.abs(r):r>180?r=360-r:r*=-1}else switch(!0){case 0==u&&90==w:case 0==u&&-90==w:case 90==u&&0==w:case 90==u&&-90==w:case-90==u&&90==w:r*=-1;break;case 0==u&&0==w:case 90==u&&90==w:-180>r?r=-1*(360+r):0>r&&(r*=-1);break;case-90==u&&-90==w:r>180?r=360-r:r*=-1;break;case-90==u&&0==w:0>r?r=Math.abs(r):r>180?r=360-r:r*=-1}r>180?r=360-r:-180>r&&(r=-1*(360+r)),g()},!1),window.DeviceMotionEvent&&window.addEventListener("devicemotion",function(n){n.accelerationIncludingGravity&&"object"==typeof n.accelerationIncludingGravity&&null!=n.accelerationIncludingGravity.x&&(d=n.accelerationIncludingGravity.x,l=n.accelerationIncludingGravity.y,s=n.accelerationIncludingGravity.z,o.x=d,o.y=l,o.z=s,g())},!1))},g=function(){if(n.length>0){var i={orientation:w,x:-1*(d*(90/v)).toFixed(0),z:r.toFixed(0),y:(s*(90/v)).toFixed(0),original:c,raw:o};0!=w&&(i.x=(l*(90/v)).toFixed(0)),e&&(i.x*=-1,i.y*=-1),0>w&&(i.x*=-1);for(var a in n)n[a](i)}};f();var y={};return y.onUpdate=function(e){n.push(e)},y});